---
output:
  pdf_document: default
  html_document: default
---

# PROJECT 1 CODING CLUB
Author: Joan Weru

### 1.Import,clean and view data

```{r echo=TRUE, message=FALSE, warning=FALSE}
library(tidyverse)
library(knitr)
setwd("~/R- CLASS DATASETS")
mobile<-read_csv("mobilemoney_data.csv")
head(mobile)
```

### 2.Select the variables "age", "gender", "education level" and "number of household members" in R and write them in a new and seperate file. Save the data set as "demographics.csv"

```{r echo=TRUE, message=FALSE, warning=FALSE}
demographics<-transmute(mobile,"age"=age,"gender"=gender,"education level"=highest_grade_completed,"numberof household members"=hh_members)
head(demographics)%>%knitr::kable()
write.csv(demographics,"~/R- CLASS DATASETS/demographics.csv")
```

### 3.Conduct exploratory analysis of the data and write a few bullet points on any descriptive statistics (summary statistics, tables and graphs) you find interesting and why you find them interesting.

  >* We first explore the different types of account types quantitatively and visually and see if we find any useful insights
  
```{r echo=TRUE, message=FALSE, warning=FALSE,fig.width=5,fig.height=5}
library(ggplot2)
library(knitr)
table(mobile$account_type)%>%knitr::kable()
account_type.perc=mobile%>%count(account_type)%>%mutate(perc=n/sum(n)*100)%>%arrange(desc(perc))
account_type.perc
ggplot(account_type.perc,aes(x="",y=n,fill=account_type))+geom_bar(width=1,stat="identity")+coord_polar(theta = "y",start=0)+theme(axis.text.x = element_blank(),axis.title = element_blank())

```
*Clearly we see that Mobile Money is leading in terms of popularity*


```{r echo=TRUE, message=FALSE, warning=FALSE,fig.height=5,fig.width=5}
library(ggplot2)
library(knitr)
library(tigerstats)
rowPerc(xtabs(~mm_account_telco_main,data=mobile))%>%knitr::kable()
mobile%>%drop_na%>%ggplot(aes(x="",y=mm_account_telco_main,fill=mm_account_telco_main))+geom_bar(width = 1,stat = "identity")+coord_polar(theta = "y",start=0,clip = "on")+scale_fill_manual(values=c("#CD8C95","#00868B","#228B22"))+theme(axis.text.x = element_blank(),axis.title = element_blank())
```

>* Are people who have been victims of fraud less likely to trust mobile money agents

```{r echo=TRUE, message=FALSE, warning=FALSE}
mobile%>%drop_na%>%count(v246,agent_trust)%>%rename("victim of fraud"=v246)%>%mutate(perc=n/sum(n)*100)%>%arrange(desc(perc))%>%knitr::kable()

```


>* We now explore the main three companies in terms of tables, and percent rows
 
```{r echo=TRUE, message=FALSE, warning=FALSE}
library(tigerstats)
table(mobile$mm_account_telco_main)%>%knitr::kable()
rowPerc(xtabs(~mm_account_telco_main,data=mobile))%>%knitr::kable()

```
 
>*Does coming from a rural or urban location influence whether they have one has an mobile money account or not
  
```{r echo=TRUE, message=FALSE, warning=FALSE}
library(tigerstats)
urban.account.relation<-rowPerc(xtabs(~urban+mm_account,data = mobile))%>%knitr::kable()
urban.account.relation
```

*people fromm urban areas have a higher chnace of owning a mobile money account*

>*We now seek to see areas where fraud cases are prevalent

```{r echo=TRUE, message=FALSE, warning=FALSE,fig.width=15,fig.height=5}
district.fraud<-rowPerc(xtabs(~district+v246,data=mobile))%>%knitr::kable()
district.fraud
mobile%>%drop_na()%>%ggplot(aes(x=district,y=v246,fill=v246))+geom_col()
```

*District A clearly has a high percentage of fraud cases, parties involved should look into the problem and seek solutions*

### 4.During the survey, participants listed all the different types of financial accounts that they have registered. The resulting data has a format where there is one observation per account type. Format the data so that there is now one observation participant. Save data as mobile_new.csv 

```{r echo=TRUE, message=FALSE, warning=FALSE}
attach(mobile)
acc_details<-select(mobile,hhid,account_type,account_num)

mobile_new<-spread(mobile,account_type,account_num)
#To replace Nas with zero
for (i in 26:33) {
  mobile_new[is.na(mobile_new[,i]),i]<-0
} 
str(mobile_new)
write.csv(mobile_new,"~/R- CLASS DATASETS/mobilenew.csv")
```


### 5.Describe how the mobile money market is divided between the three companies. Include at least one chart or table to illustrate your findings.

```{r echo=TRUE, message=FALSE, warning=FALSE,fig.height=5,fig.width=15}

acc.telco.relation<-rowPerc(xtabs(~account_type+mm_account_telco_main,data = mobile) )%>%knitr::kable()
acc.telco.relation
mobile%>%drop_na%>%ggplot(aes(x=account_type,y="",fill=account_type))+geom_col(stat="count")+facet_wrap(~mm_account_telco_main)+labs(y="count",title = "HOW THE MOBILE MONEY MARKET IS DIVIDED BETWEEN THE THREE COMPANIES")

```

### 6.Develop a cross tabulation (in percentages) with gender as the rows and columns with urban, mm_trust and prefer_cash

```{r echo=TRUE, message=FALSE, warning=FALSE}
library(gmodels)
library(knitr)
ct1<-CrossTable(mobile_new$gender,mobile_new$urban)
ct2<-CrossTable(mobile_new$gender,mobile_new$mm_trust)
ct3<-CrossTable(mobile_new$gender,mobile_new$prefer_cash)
ct4<-cbind(c(ct1$prop.row,ct2$prop.row,ct3$prop.row))
ct5<-ct4*100
ct5
```


### 7.Plot the graph of gender and mm_account in the same bar graph and clearly label your axis

```{r echo=TRUE, message=FALSE, warning=FALSE,fig.width=15,fig.height=5}
mobile%>%ggplot(aes(x=mm_account,y="",fill=mm_account))+geom_col(stat="count")+facet_wrap(~gender)+labs(y="Count",title ="RELATIONSHIP OF GENDER AND MM_ACCOUNT" )

```

### 8.Is there a difference in the share of customers who have experienced failed mobile money transactions in rural and urban villages? If so, is it statistically significant? Explain your findings including any assumptions and limitations.(Hint: Chi square test)

Chi square test is a statistical method which is used to determine if two categorical variables have a significant correlation between them. In this case our two categorical variables are failed mobile money transaction and urban

* $H_0$-he two variables are independent
* $H_1$-The two variabes relate to each other
* in this cae our level of significance is 0.05

```{r echo=TRUE, message=FALSE, warning=FALSE}

cq<-chisq.test(mobile$v240,mobile$urban)
cq

```

*our p value is less than 0.05(level of significance),we reject the null hypothesis and conclude that there is a significant relationship between failed mobile money transactions and whether one is from a rural or urban area*

